<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Map Marker Example</title>
    <!-- Mapbox CSS -->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
    <!-- Custom CSS -->
    <style>
        html{
            background-color: white;
            background-image: url("img/adrien-olichon-9zhsq3o1k60-unsplash.jpg");
        }
        body{
           margin: 30px;
        }
        #map {
            /* the width and height may be set to any size */
            width: 100%;
            height: 500px;
            border-radius: 10px;
            opacity: 60%;
            border: #c0b78a solid 3px;
        }
        .title{
            color: #E2B659;
            font-family: sans-serif;
            text-align: center;
        }
        .hrL{
            margin-bottom: 30px;
            margin-top: -20px;
            width: 100%;
            background-color: #E2B659;
        }
        .button {
            background-color: transparent;
            color: #d29b05;
            border: 2px solid #E2B659;
            transition-duration: 0.4s;
            border-radius: 4px;
            margin: 20px;
            padding: 10px;
            width: auto;
        }
        .button:hover{
            background-color: rgba(229, 190, 129, 0.99); /* Green */
            color: #B87C4C;
        }
        .divButtons {
            text-align: center;
        }
    </style>
</head>
<body>

<h1 class="title">My Favorite Restaurant in NC</h1>
<hr class="hrL">

<div id='map'></div>
<div class="divButtons">
<button id="marker" class="button">El Rodeo Location</button>
<button id="zoom-in" class="button">Zoom In</button>
<button id="pop-up" class="button"> Click to Read Message</button>
</div>

<script src="js/keys.js"></script>
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<!--<script src="mapbox-geocoder-utils.js"></script>-->
<script>
    (async function (){


        mapboxgl.accessToken = MY_MAPBOX_KEY;

        let map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v9',
            zoom: 10,
            center: [-78.639099, 35.780398]
        });

        function getLatLngFromAddress(address, token = MY_MAPBOX_KEY) {
            const url = 'https://api.mapbox.com/geocoding/v5/mapbox.places/';
            return fetch(`${url}${encodeURIComponent(address)}.json?access_token=${token}`)
                .then(async function(res) {
                    const data = await res.json();
                    console.log(data.features);
                    return data.features[0].center;
                });
        }
        let coordinates = await getLatLngFromAddress("El rodeo, NC");
        console.log(coordinates);
        const raleighMarker = new mapboxgl.Marker();
        const raleighButton = document.querySelector("#marker");
            raleighButton.addEventListener("click", function (event){
                raleighMarker.setLngLat(coordinates);
                raleighMarker.addTo(map);
            });


        const zoomIn = document.querySelector("#zoom-in");
        zoomIn.addEventListener("click", function (event){
            let currentZoom = map.getZoom();
            currentZoom++;
            map.setZoom(currentZoom);
        });
            const popUp = new mapboxgl.Popup();
        const popUpButton = document.querySelector("#pop-up");
        popUpButton.addEventListener("click", function (event){
            popUp.setLngLat([-78.636669, 35.77557]);
            popUp.addTo(map);
            popUp.setHTML("<h4>El Rodeo has the best SANGRIAS</h4>");
            console.log(popUp);
            // code if i want to tap the marker in order to display popup.
            // let marker = new mapboxgl.Marker();
            //
            // marker.setPopup(popUp);
            // marker.setLngLat([-78.636669, 35.77557]);
            // marker.addTo(map);
        });



    })();
</script>
</body>
</html>